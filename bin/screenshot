#!/usr/bin/env ruby
# Author: Gigamo <gigamo@gmail.com>
# Wrote this because I'm too lazy to upload manually all the time
# Requires scrot, imagemagick and ncftp

# Info
FTPHOST = ""
FTPPATH = ""
FTPUSER = ""
FTPPASS = ""
PICNAME = ARGV

def usage
  puts "Usage: screenshot [name]"
  puts ""
  puts "For example       - screenshot current"
  puts "                    would scrot a screenshot named current.png"
  exit 1
end

def link
  puts "Link:"
  puts ""
  puts "http://#{FTPHOST}/gigamo/#{FTPPATH}/#{PICNAME}.png"
end

def printscreen
  IO.popen("scrot #{PICNAME}.png && cp #{PICNAME}.png #{PICNAME}t.png && mogrify -resize 25% #{PICNAME}t.png") {}
end

def upload
  IO.popen("ncftpput -u #{FTPUSER} -p #{FTPPASS} -R -m #{FTPHOST} #{FTPPATH} #{PICNAME}.png #{PICNAME}t.png") {}
end

def clean
  IO.popen("rm #{PICNAME}.png #{PICNAME}t.png") {}
end

# Run the actual thing!
if ARGV.empty?
  usage
else
  printscreen
  upload
  link
  clean
  exit 0
end
