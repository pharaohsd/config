#!/bin/bash
#
# (c) Gigamo 2008
#
# Wrote this because I'm too lazy to upload a screenshot to ftp
# manually all the time :P
#
usage() {
  echo "Usage: screenshot [name]"
  echo
  echo "     no option              - scrot default directory (~/screenshots)"
  echo "     -d | --destination     - screenshot destination directory"
  echo
  echo "     For example:             screenshot current"
  echo "                              screenshot -d screenshots current"
  exit
}

link() {
  echo "Link to uploaded picture and thumbnail:"
  echo
  echo "http://$ftphost/$ftpuser/$ftppath/${picname}.png"
  echo "http://$ftphost/$ftpuser/$ftppath/${picname}t.png"
}

printscreen() {
  `cd $destdir && scrot ${picname}.png && cp ${picname}.png ${picname}t.png && mogrify -resize 25% ${picname}t.png`
}

upload() {
  ftphost=""
  ftpuser="" # Probably only required for my isp's FTP
  ftppath=""
  ftplogin=""
  ftppass=""
  `ncftpput -u $ftplogin -p $ftppass -R -m $ftphost $ftppath $pic $thumb`
}

case "$1" in
  '-d'|'--destination')
    picname=$3
    destdir=$2
    pic=$destdir/${picname}.png
    thumb=$destdir/${picname}t.png
    printscreen
    upload
    link
  ;;
  *)
    if [ -z "$1" ] ; then
      usage
    else 
      picname=$1
      destdir=~/screenshots # Default destination directory
      pic=$destdir/${picname}.png
      thumb=$destdir/${picname}t.png
      printscreen
      upload
      link
    fi
  ;;
esac
