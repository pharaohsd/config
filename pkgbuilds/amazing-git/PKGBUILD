# Contributor: Dag Odenhall <dag.odenhall@gmail.com>
pkgname=amazing-git
pkgver=20080411
pkgrel=1
pkgdesc="An amazing widget manager for an awesome window manager"
arch=('i686' 'x86_64')
url="http://amazing.rubyforge.org/"
license=('AFL')
depends=('ruby')
optdepends=("mpd: for use with MPD widget"
            "moc: for use with MOC widget"
            "raggle: for use with Raggle widget"
            "alsa-utils: for use with ALSA widget")
provides=('amazing')
conflicts=('amazing')
source=()
md5sums=()

_gitroot="git://github.com/dag/amazing.git"
_gitname="amazing"

build() {
  cd $startdir/src
  msg "Connecting to GIT server...."

  if [ -d $startdir/src/$_gitname ] ; then
    cd $_gitname && git-pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -r $startdir/src/$_gitname-build
  cp -r $startdir/src/$_gitname $startdir/src/$_gitname-build
  cd $startdir/src/$_gitname-build

  ruby setup.rb config
  ruby setup.rb install --prefix=$startdir/pkg

  install -m644 -D LICENSE $startdir/pkg/usr/share/licenses/$pkgname/LICENSE
} 
